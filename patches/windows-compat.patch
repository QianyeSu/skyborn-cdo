--- a/src/cdo.cc
+++ b/src/cdo.cc
@@ -14,7 +14,15 @@
 
 #include <sys/stat.h>
 
+#ifdef _WIN32
+#include <io.h>
+#include <windows.h>
+#ifndef STDIN_FILENO
+#define STDIN_FILENO 0
+#endif
+#else
 #include <unistd.h>  // sysconf
+#endif
 #include <cstring>
 #include <cstdlib>
 #include <csignal>
@@ -120,11 +128,24 @@
 static void
 cdo_init_is_tty()
 {
+#ifdef _WIN32
+  HANDLE hStdin = GetStdHandle(STD_INPUT_HANDLE);
+  HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE);
+  HANDLE hStderr = GetStdHandle(STD_ERROR_HANDLE);
+  DWORD mode;
+  if (hStdin != INVALID_HANDLE_VALUE && GetConsoleMode(hStdin, &mode))
+    cdo::stdinIsTerminal = true;
+  if (hStdout != INVALID_HANDLE_VALUE && GetConsoleMode(hStdout, &mode))
+    cdo::stdoutIsTerminal = true;
+  if (hStderr != INVALID_HANDLE_VALUE && GetConsoleMode(hStderr, &mode))
+    cdo::stderrIsTerminal = true;
+#else
   struct stat statbuf;
   fstat(0, &statbuf);
   if (S_ISCHR(statbuf.st_mode)) { cdo::stdinIsTerminal = true; }
   fstat(1, &statbuf);
   if (S_ISCHR(statbuf.st_mode)) { cdo::stdoutIsTerminal = true; }
   fstat(2, &statbuf);
   if (S_ISCHR(statbuf.st_mode)) { cdo::stderrIsTerminal = true; }
+#endif
 }
@@ -474,6 +495,13 @@
     totalTimer.start();
     g_processManager.run_processes();
     totalTimer.stop();
+
+    // Flush stdout before cleanup -- on Windows with PIPE-connected stdout,
+    // cleanup may hang (e.g. atexit handlers in HDF5/NetCDF libraries).
+    // Flushing here ensures all operator output (showname, sinfo, etc.)
+    // reaches the pipe before any potential hang.
+    fflush(stdout);
+
     g_processManager.clear_processes();
 
     if (Options::Timer) timer_report(allTimers);
--- a/src/merge_axis.cc
+++ b/src/merge_axis.cc
@@ -8,5 +8,7 @@
 #include <cdi.h>
 
+#ifndef _WIN32
 #include <unistd.h>
+#endif
 
 #include "process_int.h"
--- a/src/griddes.cc
+++ b/src/griddes.cc
@@ -8,5 +8,7 @@
 #include <sys/stat.h>
 #include <fcntl.h>
+#ifndef _WIN32
 #include <unistd.h>
+#endif
 #include <climits>
 
--- a/src/dcw_reader.cc
+++ b/src/dcw_reader.cc
@@ -16,4 +16,6 @@
 #include <cstdlib>
 #include <cstring>
+#ifndef _WIN32
 #include <unistd.h>
+#endif
 
--- a/src/CMOR.cc
+++ b/src/CMOR.cc
@@ -61,5 +61,7 @@
 
 #include <cassert>
+#ifndef _WIN32
 #include <unistd.h>
+#endif
 #include <netcdf.h>
 
--- a/src/cdo_zaxis.cc
+++ b/src/cdo_zaxis.cc
@@ -9,4 +9,6 @@
 #include <cstdlib>
 #include <fcntl.h>
+#ifndef _WIN32
 #include <unistd.h>
+#endif
 
--- a/src/cdo_getopt.cc
+++ b/src/cdo_getopt.cc
@@ -24,4 +24,8 @@
 #include <sys/stat.h>
 #include <stdio.h>
+#ifdef _WIN32
+#include <io.h>
+#else
 #include <unistd.h>
+#endif
 
--- a/src/expr_lex.cc
+++ b/src/expr_lex.cc
@@ -556,9 +556,11 @@
 
 #ifndef YY_NO_UNISTD_H
 /* Special case for "unistd.h", since it is non-ANSI. We include it way
  * down here because we want the user's section 1 to have been scanned first.
  * The user has a chance to override it with an option.
  */
+#ifndef _WIN32
 #include <unistd.h>
+#endif
 #endif
 
